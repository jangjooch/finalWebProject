<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="droneMission">

	<!-- 드론 미션 페이징 -->
	<resultMap type="web.dto.drone.DroneMissionDto" id="droneMemberListExam">
		<result property="d_m_number" column="d_m_number"/>
		<result property="d_number" column="d_number"/>
		<result property="re_num" column="re_num"/>
		<result property="m_num" column="m_num"/>
		<result property="d_m_start" column="d_m_start"/>
		<result property="d_m_preparation" column="d_m_preparation"/>
		<association property="memberDto" javaType="web.dto.member.MemberDto">
			<result property="m_num" column="m_num"/>
			<result property="m_name" column="m_name"/>
			<result property="m_id" column="m_id"/>
			<result property="m_pw" column="m_pw"/>
			<result property="m_phone" column="m_phone"/>
			<result property="po_num" column="po_num"/>
			<result property="po_position" column="po_position"/>
		</association>
	</resultMap>
	<select id="droneMemberListEx" resultMap="droneMemberListExam" parameterType="map">
	SELECT rn, d_m_number, d_number, re_num, m_num, d_m_start, d_m_preparation,
               m_m_num, m_name, m_id, m_pw, m_phone, po_num,       
               po_position
		FROM
		    (SELECT ROWNUM AS rn, d_m_number, d_number, re_num, m_num, d_m_start, d_m_preparation,
                              m_m_num, m_name, m_id, m_pw, m_phone, po_num,       
                              po_position
		     FROM
              (SELECT dm.d_m_number, dm.d_number, dm.re_num, dm.m_num , dm.d_m_start, dm.d_m_preparation,
                             m.m_num m_m_num, m.m_name, m.m_id, m.m_pw, m.m_phone, m.po_num,       
                             p.po_position
                      FROM 
                          drone_mission dm, member m, position p
                      WHERE 
                          m.m_num = dm.m_num AND
                          m.po_num = p.po_num
                      ORDER BY dm.d_m_number DESC)
		    WHERE ROWNUM  &lt;= #{endRowNo})
		WHERE rn  &gt;= #{startRowNo}
	</select>
	
	<!-- 드론 테이블수 Count 가져오기 -->
	<select id="selectDroneMissionCount" resultType="int">
		SELECT COUNT(*) FROM drone_mission
	</select>
	
	<!-- 게시글 상세 페이지 한 행 가져오기 -->
	<resultMap type="web.dto.drone.DroneMissionDto" id="droneMemberObject">
		<result property="d_m_number" column="d_m_number"/>
		<result property="d_number" column="d_number"/>
		<result property="re_num" column="re_num"/>
		<result property="m_num" column="m_num"/>
		<result property="d_m_start" column="d_m_start"/>
		<result property="d_m_preparation" column="d_m_preparation"/>
		<association property="memberDto" javaType="web.dto.member.MemberDto">
			<result property="m_num" column="m_num"/>
			<result property="m_name" column="m_name"/>
			<result property="m_id" column="m_id"/>
			<result property="m_pw" column="m_pw"/>
			<result property="m_phone" column="m_phone"/>
			<result property="po_num" column="po_num"/>
			<result property="po_position" column="po_position"/>
		</association>
	</resultMap>
	<select id="selectDroneMissionDetail" parameterType="int" resultMap="droneMemberObject">
		SELECT dm.d_m_number, dm.d_number, dm.re_num, dm.m_num, dm.d_m_start, dm.d_m_preparation,
		       m.m_num, m.m_name, m.m_id, m.m_pw, m.m_phone, m.po_num,       
		       p.po_position
        FROM 
            drone_mission dm, member m, position p
        WHERE 
            m.m_num = dm.m_num AND
            m.po_num = p.po_num AND
            d_m_number = #{d_m_number}
	</select>
	
	
	<!-- insert -->
	<!-- update -->
	<!-- insert -->
	
</mapper>